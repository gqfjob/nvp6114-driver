#include <linux/kernel.h>
#include <linux/version.h>
#include <linux/module.h>
#include <linux/types.h>
#include <linux/errno.h>
#include <linux/fcntl.h>
#include <linux/mm.h>
#include <linux/miscdevice.h>
#include <linux/proc_fs.h>

#include <linux/fs.h>
#include <linux/slab.h>
#include <linux/init.h>
#include <asm/uaccess.h>
#include <asm/io.h>
#include <asm/system.h>
#include <linux/interrupt.h>
#include <linux/ioport.h>
#include <linux/string.h>
#include <linux/list.h>
#include <asm/delay.h>
#include <linux/timer.h>
#include <linux/delay.h>
#include <linux/proc_fs.h>
#include <linux/poll.h>
#include <asm/bitops.h>
#include <asm/uaccess.h>
#include <asm/irq.h>
#include <linux/moduleparam.h>
#include <linux/ioport.h>
#include <linux/interrupt.h>

#include "gpio_i2c.h"
#include "nvp6114.h"

/*for 144MHz data,72M clock sampling*/
//#define SAMPLING_CLK_72M

#ifdef ONLY_720H
#define VDEC_108M
#endif

#ifndef VDEC_108M
#define VDEC_144M
#endif
#define NTSC   0
#define PAL    1
#define SET_ALL_CH          0xff


#define CON_CENTER_VAL_NTSC 0x88
#define CON_CENTER_VAL_PAL  0x88

#define BRI_CENTER_VAL_NTSC 0xFE
#define BRI_CENTER_VAL_PAL  0x00

#define HUE_CENTER_VAL_NTSC 0x01
#define HUE_CENTER_VAL_PAL  0x00

#define SAT_CENTER_VAL_NTSC 0x60 //0x80 //0x60
#define SAT_CENTER_VAL_PAL  0x60 //0x80 //0x60
//unsigned int vdec_contrast_tbl[2]    = {CON_CENTER_VAL_PAL, CON_CENTER_VAL_NTSC};
//unsigned int vdec_hue_tbl[2]         = {HUE_CENTER_VAL_PAL, HUE_CENTER_VAL_NTSC};
//unsigned int vdec_saturation_tbl[2]  = {SAT_CENTER_VAL_PAL, SAT_CENTER_VAL_NTSC};
//unsigned int vdec_brightness_tbl[2]  = {BRI_CENTER_VAL_PAL, BRI_CENTER_VAL_NTSC};

unsigned int vdec_contrast_tbl[2]    = {CON_CENTER_VAL_NTSC, CON_CENTER_VAL_PAL};
unsigned int vdec_hue_tbl[2]         = {HUE_CENTER_VAL_NTSC, HUE_CENTER_VAL_PAL};
unsigned int vdec_saturation_tbl[2]  = {SAT_CENTER_VAL_NTSC, SAT_CENTER_VAL_PAL};
unsigned int vdec_brightness_tbl[2]  = {BRI_CENTER_VAL_NTSC, BRI_CENTER_VAL_PAL};
unsigned char vdec_motion_sens_tbl[8]= {0xe0,0xc8,0xa0,0x98,0x78,0x68,0x50,0x48};
extern unsigned int vdec_cnt;
extern int chip_id[4];
extern unsigned int vdec_mode;
extern void audio_init(unsigned char dec, unsigned char ch_num, unsigned char samplerate, unsigned char bits);
/***************************************************************************************/
/************************************ 720P@30fps ***************************************/
/***************************************************************************************/

////////////////////////////////////////////////////////////////////////////////////////////////
/*
                                         NVP6114_AHD_30P_(140621_ver.0.1)          
*/
////////////////////////////////////////////////////////////////////////////////////////////////
unsigned char NVP6114_B0_30P_Buf[] = {
      // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
/*0x00*/ 0x00,0x00,0x20,0x03,0x00,0x00,0xaf,0x00,0x60,0x60,0x60,0x60,0x08,0x08,0x08,0x08,
/*0x10*/ 0x88,0x88,0x88,0x88,0x90,0x90,0x90,0x90,0x00,0x00,0x00,0x00,0x04,0x04,0x04,0x04,
/*0x20*/ 0x00,0x00,0x00,0x00,0x2f,0x92,0x0b,0x43,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x30*/ 0x17,0x17,0x17,0x17,0x2f,0x92,0x0b,0x43,0x0a,0x0a,0x0a,0x0a,0x84,0x84,0x84,0x84,
/*0x40*/ 0xFD,0xFD,0xFD,0xFD,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x04,0x04,0x04,0x04,
/*0x50*/ 0x04,0x04,0x04,0x04,0xf1,0x10,0x10,0x00,0xa0,0xa0,0xa0,0xa0,0x9e,0x9e,0x9e,0x9e,
/*0x60*/ 0x00,0x00,0x00,0x00,0x8d,0x8d,0x8d,0x8d,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x70*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x88,0x88,0x11,0x11,0x00,0x00,0x00,0x00,
/*0x80*/ 0x00,0x00,0x02,0x80,0x04,0x04,0x08,0x04,0x0c,0x00,0x08,0x0e,0x80,0x20,0x0a,0x08,
/*0x90*/ 0x30,0x42,0x80,0x0a,0x7a,0x88,0x6c,0x5e,0x18,0x1f,0x8e,0x94,0xc7,0xa3,0xa0,0x0a,
/*0xa0*/ 0x00,0x00,0x02,0x80,0x04,0x04,0x08,0x04,0x0c,0x00,0x08,0x0e,0x80,0x20,0x0a,0x08,
/*0xb0*/ 0x30,0x42,0x80,0x0a,0x7a,0x88,0x6c,0x5e,0x18,0x1f,0x8e,0x94,0xc7,0xa3,0xa0,0x0a,
/*0xc0*/ 0x01,0x01,0x01,0x01,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x00,0x00,0x00,0x00,
/*0xd0*/ 0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xe0*/ 0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};


unsigned char NVP6114_B1_30P_Buf[] = {
      // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
/*0x00*/ 0x02,0x0f,0x0f,0x0f,0x0f,0x0f,0x1b,0x80,0x03,0x00,0x10,0x32,0x54,0x76,0x00,0x98,
/*0x10*/ 0xba,0xdc,0xfe,0x00,0x00,0x00,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,
/*0x20*/ 0x88,0x88,0x03,0x19,0x18,0x16,0x00,0x00,0x00,0x88,0xff,0x40,0xaa,0xaa,0xaa,0xaa,
/*0x30*/ 0xaa,0x82,0x00,0x00,0x00,0x8C,0xA0,0x00,0x18,0x01,0x80,0x30,0x00,0x00,0x80,0x00,
/*0x40*/ 0x0f,0x0f,0x0f,0x0f,0x11,0xBB,0x81,0x55,0x60,0x00,0x03,0x10,0x00,0x00,0x00,0x00,
/*0x50*/ 0xDD,0x00,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x60*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x70*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x80*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x90*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xa0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xb0*/ 0xff,0xff,0xff,0xff,0x40,0x30,0x40,0x30,0x40,0x30,0x40,0x30,0x00,0x00,0x00,0x00,
/*0xc0*/ 0x32,0x32,0x10,0x10,0x10,0x32,0x54,0x76,0x22,0x88,0x03,0x00,0x66,0x66,0x70,0x70,
/*0xd0*/ 0x00,0x00,0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x0f,0x0f,0xff,0x00,0x02,0x00,
/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x90,0x00,0x00,0x00,0x0f,0x0f,0x0f,0xff,
/*0xf0*/ 0xff,0xaa,0x66,0x00,0x83,0x70,0x00,0x1a,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0x01
};


unsigned char NVP6114_B2_30P_Buf[] = {
   // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
/*0x00*/ 0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,
/*0x10*/ 0x00,0x00,0x00,0x00,0xc0,0x00,0x55,0x55,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x20*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x30*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x40*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x50*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x60*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x70*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x80*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x90*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xa0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xb0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xc0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xd0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x74,0x00,0x74,0x00,0xff,0xff,0xff,0x02
};      

unsigned char NVP6114_B3_30P_Buf[] = {
      // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
/*0x00*/ 0xe0,0x0f,0x0c,0x1f,0x00,0x24,0x60,0x80,0x50,0x38,0x0f,0x00,0x04,0x10,0x30,0x00,
/*0x10*/ 0x06,0x06,0x00,0x80,0x37,0x80,0x49,0x37,0xef,0xdf,0xdf,0x08,0x50,0x0c,0xff,0x88,
/*0x20*/ 0x84,0x20,0x23,0x00,0x2a,0xdd,0xf0,0x57,0x90,0x70,0x52,0x78,0x04,0x68,0x00,0x07,
/*0x30*/ 0xe0,0x43,0xa2,0x00,0x00,0x15,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xaa,0x00,0x00,0x00,0x00,0x00,
/*0x50*/ 0x04,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x60,0x00,0x00,0x30,
/*0x60*/ 0x53,0x53,0x20,0x00,0x22,0x22,0x22,0x22,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,
/*0x70*/ 0xc0,0x01,0x06,0x06,0x11,0x00,0x0f,0x8f,0x0f,0x0f,0x0f,0x8f,0x0f,0x0f,0x00,0x00,
/*0x80*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x90*/ 0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xb0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xc0*/ 0x10,0x30,0x0c,0x50,0x10,0x34,0x70,0x5C,0x20,0x20,0x30,0x40,0x20,0x20,0x14,0x20,
/*0xd0*/ 0x40,0x50,0x0e,0x00,0x80,0x80,0x00,0x00,0x39,0xb2,0x05,0x00,0xc0,0x00,0x00,0x00,
/*0xe0*/ 0xa0,0x00,0x01,0x01,0x02,0xa0,0x02,0x05,0x04,0x0b,0xa0,0x06,0x17,0x08,0x30,0x00,
/*0xf0*/ 0x09,0xa0,0xf8,0x00,0x00,0x00,0x00,0x00,0x01,0x05,0x87,0x0b,0x8e,0x11,0x64,0x03
};

 
 unsigned char NVP6114_B4_30P_Buf[] = {
      // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
/*0x00*/ 0x02,0x04,0x06,0x08,0x0c,0x10,0x14,0x18,0x1c,0x20,0x28,0x30,0x38,0x40,0x48,0x50,
/*0x10*/ 0x58,0x60,0x68,0x70,0x78,0x7f,0x87,0x8f,0x97,0x9f,0xaf,0xbf,0xcf,0xdf,0xef,0xff,
/*0x20*/ 0x01,0x03,0x05,0x07,0x0b,0x0f,0x13,0x17,0x1b,0x1f,0x27,0x2f,0x37,0x3f,0x47,0x4f,
/*0x30*/ 0x57,0x5f,0x67,0x6f,0x77,0x7f,0x87,0x8f,0x97,0x9f,0xaf,0xbf,0xcf,0xdf,0xef,0xff,
/*0x40*/ 0x00,0x0f,0x06,0x00,0xf5,0x28,0x5c,0x51,0xf5,0x28,0x5c,0x51,0x00,0x00,0x00,0x00,
/*0x50*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff,0x00,0x00,0x00,
/*0x60*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x11,0x11,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x70*/ 0xff,0x77,0x77,0x00,0x00,0x00,0x00,0x00,0x16,0x16,0x16,0x16,0x00,0x00,0x00,0x00,
/*0x80*/ 0x37,0x37,0x1b,0x05,0x00,0x07,0x00,0x09,0x00,0x00,0x08,0x06,0x00,0x46,0x00,0x00,
/*0x90*/ 0xaa,0x1c,0x18,0xff,0xaa,0x3c,0xff,0xff,0xaa,0x1b,0x00,0x00,0xaa,0x3b,0x00,0x00,
/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,
/*0xb0*/ 0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x32,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xc0*/ 0x37,0x37,0x1b,0x05,0x00,0x07,0x00,0x09,0x00,0x00,0x08,0x06,0x00,0x46,0x00,0x00,
/*0xd0*/ 0xaa,0x1c,0x18,0xff,0xaa,0x3c,0xff,0xff,0xaa,0x1b,0x00,0x00,0xaa,0x3b,0x00,0x00,
/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,
/*0xf0*/ 0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x32,0x00,0x00,0x00,0x00,0x00,0x04
};    


 unsigned char NVP6114_B5_30P_Buf[] = {
	 //	 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
/*0x00*/ 0xe0,0x0f,0x0c,0x1f,0x00,0x24,0x60,0x80,0x50,0x38,0x0f,0x00,0x04,0x10,0x30,0x00,
/*0x10*/ 0x06,0x06,0x00,0x80,0x37,0x80,0x49,0x37,0xef,0xdf,0xdf,0x08,0x50,0x0c,0xff,0x88,
/*0x20*/ 0x84,0x20,0x23,0x00,0x2a,0xdd,0xf0,0x57,0x90,0x70,0x52,0x78,0x00,0x68,0x00,0x07,
/*0x30*/ 0xe0,0x43,0xa2,0x00,0x00,0x15,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xaa,0x00,0x00,0x00,0x00,0x00,
/*0x50*/ 0x04,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x60,0x00,0x00,0x30,
/*0x60*/ 0x53,0x53,0x20,0x00,0x22,0x22,0x22,0x22,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,
/*0x70*/ 0xc0,0x01,0x06,0x06,0x11,0x00,0x0f,0x8f,0x0f,0x0f,0x0f,0x8f,0x0f,0x0f,0x00,0x00,
/*0x80*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x90*/ 0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xb0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xc0*/ 0x10,0x30,0x0c,0x50,0x10,0x34,0x70,0x5C,0x20,0x20,0x30,0x40,0x20,0x20,0x14,0x20,
/*0xd0*/ 0x40,0x50,0x0e,0x00,0x80,0x80,0x00,0x00,0x39,0xb2,0x05,0x00,0xc0,0x00,0x00,0x00,
/*0xe0*/ 0xa0,0x00,0x01,0x01,0x02,0xa0,0x02,0x05,0x04,0x0b,0xa0,0x06,0x17,0x08,0x30,0x00,
/*0xf0*/ 0x09,0xa0,0xf8,0x00,0x00,0x00,0x00,0x00,0x01,0x05,0x87,0x0b,0x8e,0x11,0x64,0x05 
 };		
 
 
////////////////////////////////////////////////////////////////////////////////////////////////
/*
                                          NVP6114_AHD_25P        
*/
////////////////////////////////////////////////////////////////////////////////////////////////

unsigned char NVP6114_B0_25P_Buf[] = {
	    // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
/*0x00*/ 0x00,0x00,0x20,0x03,0x00,0x00,0xaf,0x00,0x60,0x60,0x60,0x60,0x08,0x08,0x08,0x08,
/*0x10*/ 0x88,0x88,0x88,0x88,0x90,0x90,0x90,0x90,0x00,0x00,0x00,0x00,0x02,0x02,0x02,0x02,
/*0x20*/ 0x00,0x00,0x00,0x00,0x2f,0x92,0x0b,0x43,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x30*/ 0x17,0x17,0x17,0x17,0x2f,0x92,0x0b,0x43,0x0a,0x0a,0x0a,0x0a,0x84,0x84,0x84,0x84,
/*0x40*/ 0x00,0x00,0x00,0x00,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x04,0x04,0x04,0x04,
/*0x50*/ 0x04,0x04,0x04,0x04,0x01,0x10,0x10,0x00,0x64,0x64,0x64,0x64,0x9e,0x9e,0x9e,0x9e,
/*0x60*/ 0x00,0x00,0x00,0x00,0x8d,0x8d,0x8d,0x8d,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x70*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x88,0x88,0x11,0x11,0x00,0x00,0x00,0x00,
/*0x80*/ 0x00,0x00,0x02,0x80,0x04,0x04,0x08,0x04,0x0c,0x00,0x08,0x0e,0x80,0x20,0x0a,0x08,
/*0x90*/ 0x30,0x42,0x80,0x0a,0x7a,0x88,0x6c,0x5e,0x18,0x1f,0x8e,0x94,0xc7,0xa3,0xa0,0x0a,
/*0xa0*/ 0x00,0x00,0x02,0x80,0x04,0x04,0x08,0x04,0x0c,0x00,0x08,0x0e,0x80,0x20,0x0a,0x08,
/*0xb0*/ 0x30,0x42,0x80,0x0a,0x7a,0x88,0x6c,0x5e,0x18,0x1f,0x8e,0x94,0xc7,0xa3,0xa0,0x0a,
/*0xc0*/ 0x01,0x01,0x01,0x01,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x00,0x00,0x00,0x00,
/*0xd0*/ 0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xe0*/ 0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

unsigned char NVP6114_B1_25P_Buf[] = {
	//	0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
/*0x00*/ 0x02,0x0f,0x0f,0x0f,0x0f,0x0f,0x1b,0x80,0x03,0x00,0x10,0x32,0x54,0x76,0x00,0x98,
/*0x10*/ 0xba,0xdc,0xfe,0x00,0x00,0x00,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,
/*0x20*/ 0x88,0x88,0x03,0x19,0x18,0x16,0x00,0x00,0x00,0x88,0xff,0x40,0xaa,0xaa,0xaa,0xaa,
/*0x30*/ 0xaa,0x82,0x00,0x00,0x00,0x8C,0xA0,0x00,0x18,0x01,0x80,0x30,0x00,0x00,0x80,0x00,
/*0x40*/ 0x0f,0x0f,0x0f,0x0f,0x11,0xBB,0x81,0x55,0x60,0x00,0x03,0x10,0x00,0x00,0x00,0x00,
/*0x50*/ 0xDD,0x00,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x60*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x70*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x80*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x90*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xa0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xb0*/ 0xff,0xff,0xff,0xff,0x40,0x30,0x40,0x30,0x40,0x30,0x40,0x30,0x00,0x00,0x00,0x00,
/*0xc0*/ 0x32,0x32,0x10,0x10,0x10,0x32,0x54,0x76,0x22,0x88,0x03,0x00,0x66,0x66,0x70,0x70,
/*0xd0*/ 0x00,0x00,0x00,0xff,0x00,0x00,0x00,0x00,0x0e,0x01,0x00,0x01,0x00,0x00,0x00,0x00,
/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x90,0x00,0x00,0x00,0x01,0x0f,0x01,0xff,
/*0xf0*/ 0xab,0x00,0x77,0x0e,0x83,0x70,0xff,0x1a,0x00,0x0e,0x00,0x0e,0xff,0xff,0xff,0x01
};

unsigned char NVP6114_B2_25P_Buf[] = {
//	0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
/*0x00*/ 0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,
/*0x10*/ 0x00,0x00,0x00,0x00,0xc0,0x00,0x55,0x55,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x20*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x30*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x40*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x50*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x60*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x70*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x80*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x90*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xa0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xb0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xc0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xd0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x90,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3c,0x00,0x3c,0x00,0xff,0xff,0xff,0x02
};

unsigned char NVP6114_B3_25P_Buf[] = {
      //	0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
/*0x00*/ 0xe0,0x0f,0x0c,0x1f,0x00,0x24,0x60,0x80,0x50,0x38,0x0f,0x00,0x04,0x10,0x30,0x00,
/*0x10*/ 0x06,0x06,0x00,0x80,0x37,0x80,0x49,0x37,0xef,0xdf,0xdf,0x08,0x50,0x0c,0x00,0x88,
/*0x20*/ 0x84,0x20,0x23,0x00,0x2a,0xdd,0xf0,0x57,0x90,0x70,0x52,0x78,0x00,0x68,0x00,0x07,
/*0x30*/ 0xe0,0x43,0xa2,0x00,0x00,0x17,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xaa,0x00,0x00,0x00,0x00,0x00,
/*0x50*/ 0x04,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x70,0x00,0x00,0x30,
/*0x60*/ 0x53,0x53,0x20,0x00,0x22,0x22,0x22,0x22,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,
/*0x70*/ 0xc0,0x01,0x06,0x06,0x11,0x00,0x0f,0x8f,0x0f,0x0f,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x80*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x90*/ 0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xb0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xc0*/ 0x10,0x10,0x0e,0x70,0x10,0x34,0x70,0x5c,0x40,0x20,0x30,0x40,0x10,0x08,0x04,0x20,
/*0xd0*/ 0x40,0x50,0x0e,0x00,0x80,0x80,0x00,0x00,0x39,0xb2,0x05,0x00,0xc0,0x00,0x00,0x00,
/*0xe0*/ 0xa0,0x00,0x01,0x01,0x02,0xa0,0x02,0x05,0x04,0x0b,0xa0,0x06,0x17,0x08,0x30,0x00,
/*0xf0*/ 0x09,0xa0,0xf8,0x00,0x00,0x00,0x00,0x00,0x01,0x05,0x87,0x0b,0x8e,0x11,0x64,0x03
};

unsigned char NVP6114_B4_25P_Buf[] = {
	    //	0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
/*0x00*/ 0x02,0x04,0x06,0x08,0x0c,0x10,0x14,0x18,0x1c,0x20,0x28,0x30,0x38,0x40,0x48,0x50,
/*0x10*/ 0x58,0x60,0x68,0x70,0x78,0x7f,0x87,0x8f,0x97,0x9f,0xaf,0xbf,0xcf,0xdf,0xef,0xff,
/*0x20*/ 0x01,0x03,0x05,0x07,0x0b,0x0f,0x13,0x17,0x1b,0x1f,0x27,0x2f,0x37,0x3f,0x47,0x4f,
/*0x30*/ 0x57,0x5f,0x67,0x6f,0x77,0x7f,0x87,0x8f,0x97,0x9f,0xaf,0xbf,0xcf,0xdf,0xef,0xff,
/*0x40*/ 0x00,0x0f,0x06,0x00,0x88,0x88,0x88,0x51,0x88,0x88,0x88,0x51,0x00,0x00,0x00,0x00,
/*0x50*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff,0x00,0x00,0x00,
/*0x60*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x11,0x11,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x70*/ 0xff,0xaa,0xaa,0x00,0x00,0x00,0x00,0x00,0x16,0x16,0x16,0x16,0x00,0x00,0x00,0x00,
/*0x80*/ 0x37,0x37,0x1b,0x05,0x00,0x07,0x00,0x09,0x00,0x00,0x08,0x06,0x00,0x46,0x00,0x00,
/*0x90*/ 0xaa,0x1c,0x18,0xff,0xaa,0x3c,0xff,0xff,0xaa,0x1b,0x00,0x00,0xaa,0x3b,0x00,0x00,
/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,
/*0xb0*/ 0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x32,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xc0*/ 0x37,0x37,0x1b,0x05,0x00,0x07,0x00,0x09,0x00,0x00,0x08,0x06,0x00,0x46,0x00,0x00,
/*0xd0*/ 0xaa,0x1c,0x18,0xff,0xaa,0x3c,0xff,0xff,0xaa,0x1b,0x00,0x00,0xaa,0x3b,0x00,0x00,
/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,
/*0xf0*/ 0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x32,0x00,0x00,0x00,0x00,0x00,0x04
};


unsigned char NVP6114_B5_25P_Buf[] = {
	 //	 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0A 0x0B 0x0C 0x0D 0x0E 0x0F
/*0x00*/ 0xe0,0x0f,0x0c,0x1f,0x00,0x24,0x60,0x80,0x50,0x38,0x0f,0x00,0x04,0x10,0x30,0x00,
/*0x10*/ 0x06,0x06,0x00,0x80,0x37,0x80,0x49,0x37,0xef,0xdf,0xdf,0x08,0x50,0x0c,0x00,0x88,
/*0x20*/ 0x84,0x20,0x23,0x00,0x2a,0xdd,0xf0,0x57,0x90,0x70,0x52,0x78,0x00,0x68,0x00,0x07,
/*0x30*/ 0xe0,0x43,0xa2,0x00,0x00,0x17,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xaa,0x00,0x00,0x00,0x00,0x00,
/*0x50*/ 0x04,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x70,0x00,0x00,0x30,
/*0x60*/ 0x53,0x53,0x20,0x00,0x22,0x22,0x22,0x22,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,
/*0x70*/ 0xc0,0x01,0x06,0x06,0x11,0x00,0x0f,0x8f,0x0f,0x0f,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x80*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x90*/ 0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xb0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xc0*/ 0x10,0x10,0x0e,0x70,0x10,0x34,0x70,0x5c,0x40,0x20,0x30,0x40,0x10,0x08,0x04,0x20,
/*0xd0*/ 0x40,0x50,0x0e,0x00,0x80,0x80,0x00,0x00,0x39,0xb2,0x05,0x00,0xc0,0x00,0x00,0x00,
/*0xe0*/ 0xa0,0x00,0x01,0x01,0x02,0xa0,0x02,0x05,0x04,0x0b,0xa0,0x06,0x17,0x08,0x30,0x00,
/*0xf0*/ 0x09,0xa0,0xf8,0x00,0x00,0x00,0x00,0x00,0x01,0x05,0x87,0x0b,0x8e,0x11,0x64,0x05
 };


void vdec_ntsc_common_init(int i);
void vdec_pal_common_init(int i);
//void vdec_ntsc_common_init(void);
//void vdec_pal_common_init(void);
//void nvp6114_720p_30fps(unsigned int i);
//void nvp6114_720p_25fps(unsigned int i);
void vdec_write_table(unsigned char chip_addr, unsigned char addr, unsigned char *tbl_ptr, unsigned char tbl_cnt);


extern unsigned int vdec_mode;
extern unsigned int vdec_slave_addr[2];
void NCdecoder_AfeReset(void)
{
	gpio_i2c_write(vdec_slave_addr[0], 0xFF, 0x00);
	gpio_i2c_write(vdec_slave_addr[1], 0xFF, 0x00);
	gpio_i2c_write(vdec_slave_addr[0], 0x02, gpio_i2c_read(vdec_slave_addr[0], 0x02)|0x0F);
	gpio_i2c_write(vdec_slave_addr[1], 0x02, gpio_i2c_read(vdec_slave_addr[1], 0x02)|0x0F);
	gpio_i2c_write(vdec_slave_addr[0], 0x02, gpio_i2c_read(vdec_slave_addr[0], 0x02)&0xF0);
	gpio_i2c_write(vdec_slave_addr[1], 0x02, gpio_i2c_read(vdec_slave_addr[1], 0x02)&0xF0);
	printk("AFE reset done\n");
}
EXPORT_SYMBOL(NCdecoder_AfeReset);

void wpd_control(unsigned char ison)
{
	int i = 0;

	for(i=0;i<vdec_cnt;i++)
	{
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x03);
		gpio_i2c_write(vdec_slave_addr[i], 0x70, 0xb8);
		gpio_i2c_write(vdec_slave_addr[i], 0x71, 0x01);
		gpio_i2c_write(vdec_slave_addr[i], 0x72, 0x06);
		gpio_i2c_write(vdec_slave_addr[i], 0x73, 0x11);
		gpio_i2c_write(vdec_slave_addr[i], 0x74, (ison==1)?0x91:0x11);
		gpio_i2c_write(vdec_slave_addr[i], 0x77, 0x03);
		gpio_i2c_write(vdec_slave_addr[i], 0x78, 0x03);
		gpio_i2c_write(vdec_slave_addr[i], 0x79, 0x22);
	}	
	printk("wpd_control %s\n", ison?"ON":"OFF");
}
EXPORT_SYMBOL(wpd_control);

void set_4ch_videosequence(void)
{
	gpio_i2c_write(vdec_slave_addr[0], 0xFF, 0x01);
	gpio_i2c_write(vdec_slave_addr[0], 0xC0, 0x10);  //change video sequence here.
	gpio_i2c_write(vdec_slave_addr[0], 0xC1, 0x32);
	gpio_i2c_write(vdec_slave_addr[0], 0xCA, 0x01);  //only enable video port1
}

void vdec_system_init2(int i)
{
//    int i = 0;                               
//	for(i=0;i<vdec_cnt;i++)
	{
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x01); 
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x40); 
		gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x02);		
		
		gpio_i2c_write(vdec_slave_addr[i], 0x4A, 0x03); 
		gpio_i2c_write(vdec_slave_addr[i], 0x4B, 0x10); 		
		
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x61);
		gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x00);
		msleep(100); 
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x60); 
		gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x00);
		gpio_i2c_write(vdec_slave_addr[i], 0x3e, 0x80);	 
		gpio_i2c_write(vdec_slave_addr[i], 0x38, 0x18);
		gpio_i2c_write(vdec_slave_addr[i], 0x38, 0x08);   
		msleep(100); 
	}

	printk("\n\rgrain media system init!!!");
}
void nvp6114_vafe_reset(int i)
{
	gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x03); 
	gpio_i2c_write(vdec_slave_addr[i], 0x01, 0xc9); 
	msleep(100); 
	gpio_i2c_write(vdec_slave_addr[i], 0x01, 0x09); 
	printk("\n\r nvp6114 vafe reset 08.18!!!");
}
void software_reset(int i)
{
//	  int i = 0;                               
//	for(i=0;i<vdec_cnt;i++)
	{
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x01); 
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x40); 
		gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x02);
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x61);
		gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x00);
		msleep(100); 
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x60); 
		gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x00);
		msleep(100); 
	}
	printk("\n\r nvp6114 software reset !!!");
}



void vdec_system_init(void)
{                                            
    int i = 0;                               
	for(i=0;i<vdec_cnt;i++)
	{
	#if 0  //ver0.0.1
	   #ifdef VDEC_108M
		//============== Bank 1 =====================//
		// PLL Divider value setting (108Mhz 27M_H720)
		gpio_i2c_write(vdec_slave_addr[i], 0xff, 0x01);
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x60);
		gpio_i2c_write(vdec_slave_addr[i], 0x4a, 0x22);
		gpio_i2c_write(vdec_slave_addr[i], 0x4b, 0x20);
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x61);
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x60);
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x40);
		gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x02);
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x60);
		gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x00);
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x40);
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x60);
		gpio_i2c_write(vdec_slave_addr[i], 0x3E, 0x00);
		gpio_i2c_write(vdec_slave_addr[i], 0x38, 0x10);
	   #else
	   //============== Bank 1 =====================//
	   // PLL Divider value setting (144Mhz 36M_H720)
		gpio_i2c_write(vdec_slave_addr[i], 0xff, 0x01);	
		gpio_i2c_write(vdec_slave_addr[i], 0x4a, 0x03);
		gpio_i2c_write(vdec_slave_addr[i], 0x4b, 0x10);
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x60);
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x61);
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x40);
		gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x02);
		gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x60);
		gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x00);
		gpio_i2c_write(vdec_slave_addr[i], 0x5e, 0x80);
		gpio_i2c_write(vdec_slave_addr[i], 0x38, 0x18);
		gpio_i2c_write(vdec_slave_addr[i], 0x38, 0x08);

	   #endif 	 
	#else
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x01); 
		#ifdef VDEC_108M  
		  gpio_i2c_write(vdec_slave_addr[i], 0x4A, 0x22);   
		  gpio_i2c_write(vdec_slave_addr[i], 0x4B, 0x20); 
		#else    //(144Mhz 36M_H960 & AHD )
	    gpio_i2c_write(vdec_slave_addr[i], 0x4A, 0x03);   
	    gpio_i2c_write(vdec_slave_addr[i], 0x4B, 0x10); 
		#endif 
	    gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x60);   
	    gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x61);   
	    msleep(100);                             
	    gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x40);   
	    gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x02);   
	    msleep(10);                              
	    gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x60);   
	    gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x00);   
	    msleep(10);                              
	    gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x40);   
	    gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x60);   
		#ifdef VDEC_108M //(108Mhz 27M_H720)
		  gpio_i2c_write(vdec_slave_addr[i], 0x3e, 0x00);   
		#else  //(144Mhz 36M_H960 & AHD )
	    gpio_i2c_write(vdec_slave_addr[i], 0x3e, 0x80);   
		#endif
	    gpio_i2c_write(vdec_slave_addr[i], 0x38, 0x18);   
	    gpio_i2c_write(vdec_slave_addr[i], 0x38, 0x08);   
	    msleep(100);
	#endif
	}
}           

void vdec_ntsc_common_init(int i)
{
//	int i = 0;

//	for(i=0;i<vdec_cnt;i++)
	{
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x00);
        vdec_write_table(vdec_slave_addr[i],0x00,NVP6114_B0_30P_Buf,254);
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x01);
        vdec_write_table(vdec_slave_addr[i],0x00,NVP6114_B1_30P_Buf,254);
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x02);
        vdec_write_table(vdec_slave_addr[i],0x00,NVP6114_B2_30P_Buf,254);
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x03);
        vdec_write_table(vdec_slave_addr[i],0x00,NVP6114_B3_30P_Buf,254);
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x04);
        vdec_write_table(vdec_slave_addr[i],0x00,NVP6114_B4_30P_Buf,254);
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x05);
        vdec_write_table(vdec_slave_addr[i],0x00,NVP6114_B5_30P_Buf,254);	
	}
}

void vdec_pal_common_init(int i)
{
//	int i = 0;

//	for(i=0;i<vdec_cnt;i++)
	{
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x00);
        vdec_write_table(vdec_slave_addr[i],0x00,NVP6114_B0_25P_Buf,254);
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x01);
        vdec_write_table(vdec_slave_addr[i],0x00,NVP6114_B1_25P_Buf,254);
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x02);
        vdec_write_table(vdec_slave_addr[i],0x00,NVP6114_B2_25P_Buf,254);
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x03);
        vdec_write_table(vdec_slave_addr[i],0x00,NVP6114_B3_25P_Buf,254);
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x04);
        vdec_write_table(vdec_slave_addr[i],0x00,NVP6114_B4_25P_Buf,254);
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x05);
        vdec_write_table(vdec_slave_addr[i],0x00,NVP6114_B5_25P_Buf,254);
	}
}
void mpp2clk_72M(unsigned char channel_mode)
{
	int i=0;
	unsigned char ch12_960H=0;
	unsigned char ch34_960H=0;
	if(channel_mode&0x03)
		ch12_960H = 1;
	if(channel_mode&0x0C)
		ch34_960H = 1;

	gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x01);
	gpio_i2c_write(vdec_slave_addr[i], 0xD4, 0x03);  //mpp1&mpp2 port clock func enables
	if( ch12_960H == 1 && ch34_960H == 1 )
	{
		gpio_i2c_write(vdec_slave_addr[i], 0xB4, 0x03);//0x56);//0x43);  //clock&delay setting
		gpio_i2c_write(vdec_slave_addr[i], 0xB5, 0x03);//0x56);//0x43);
	}
	else if( ch12_960H == 1 )
	{
		gpio_i2c_write(vdec_slave_addr[i], 0xB4, 0x43);//0x56);//0x43);  //clock&delay setting
		gpio_i2c_write(vdec_slave_addr[i], 0xB5, 0x03);//0x56);//0x43);
	}
	else if( ch34_960H == 1 )
	{
		gpio_i2c_write(vdec_slave_addr[i], 0xB4, 0x03);//0x56);//0x43);  //clock&delay setting
		gpio_i2c_write(vdec_slave_addr[i], 0xB5, 0x43);//0x56);//0x43);
	}
	else
	{
		gpio_i2c_write(vdec_slave_addr[i], 0xB4, 0x43);//0x56);//0x43);  //clock&delay setting
		gpio_i2c_write(vdec_slave_addr[i], 0xB5, 0x43);//0x56);//0x43);
	}
		
}
/***********FUNC:nvp6114_960H_setting***************/
//vformat:0->NTSC  1->PAL
//channel_mode: 
//0x00 --> ALL channel 720P mode
//0x03 --> 1/2 channel 960H + 3/4 channel 720P mode
//0x0c --> 1/2 channel 720P + 3/4 channel 960H mode
//0x0F --> ALL channel 960H mode
void nvp6114_960H_setting(unsigned char vformat, unsigned char channel_mode, unsigned int i)
{
//	int i;
	unsigned char ch12_960H=0;
	unsigned char ch34_960H=0;
	if(channel_mode&0x03)
		ch12_960H = 1;
	if(channel_mode&0x0C)
		ch34_960H = 1;
//	for(i=0;i<vdec_cnt;i++)
	{
		if(ch12_960H==ch34_960H)
		{
			gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x04);  //bank4
			gpio_i2c_write(vdec_slave_addr[i], 0x5F, 0x00);
		}
		else
		{
			gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x04);  //bank4
			gpio_i2c_write(vdec_slave_addr[i], 0x5F, 0x01);  //each bank setting
		}	
		
		/************bank 0 diff setting *************/
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x00);  //bank0
		gpio_i2c_write(vdec_slave_addr[i], 0x54, vformat==PAL?0x01:0xf1);
		if(1==ch12_960H)
		{
			gpio_i2c_write(vdec_slave_addr[i], 0x08, vformat==PAL?0xDD:0xA0);
			gpio_i2c_write(vdec_slave_addr[i], 0x09, vformat==PAL?0xDD:0xA0);
			gpio_i2c_write(vdec_slave_addr[i], 0x14, 0x90);
			gpio_i2c_write(vdec_slave_addr[i], 0x15, 0x90);
			gpio_i2c_write(vdec_slave_addr[i], 0x18, 0x88);		
			gpio_i2c_write(vdec_slave_addr[i], 0x1A, 0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0x1C, vformat==PAL?0x02:0x04);
			gpio_i2c_write(vdec_slave_addr[i], 0x1D, vformat==PAL?0x02:0x04);
			gpio_i2c_write(vdec_slave_addr[i], 0x40, vformat==PAL?0x00:0x01);
			gpio_i2c_write(vdec_slave_addr[i], 0x41, vformat==PAL?0x00:0x01);
			gpio_i2c_write(vdec_slave_addr[i], 0x48, vformat==PAL?0x00:0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0x49, vformat==PAL?0x00:0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0x58, vformat==PAL?0x50:0x33); // resulve pal black left problem
			gpio_i2c_write(vdec_slave_addr[i], 0x59, vformat==PAL?0x50:0x33);
			gpio_i2c_write(vdec_slave_addr[i], 0x5C, 0x1E);
			gpio_i2c_write(vdec_slave_addr[i], 0x5D, 0x1E);
			gpio_i2c_write(vdec_slave_addr[i], 0x64, vformat==PAL?0x0D:0x08);
			gpio_i2c_write(vdec_slave_addr[i], 0x65, vformat==PAL?0x0D:0x08);
		}
		else if(0==ch12_960H)
		{
			gpio_i2c_write(vdec_slave_addr[i], 0x08, 0x60);
			gpio_i2c_write(vdec_slave_addr[i], 0x09, 0x60);
			gpio_i2c_write(vdec_slave_addr[i], 0x14, 0x9f);
			gpio_i2c_write(vdec_slave_addr[i], 0x15, 0x9f);
			gpio_i2c_write(vdec_slave_addr[i], 0x18, 0x00);		
			gpio_i2c_write(vdec_slave_addr[i], 0x1A, 0x11);  
			gpio_i2c_write(vdec_slave_addr[i], 0x1C, vformat==PAL?0x02:0x04);
			gpio_i2c_write(vdec_slave_addr[i], 0x1D, vformat==PAL?0x02:0x04);
			gpio_i2c_write(vdec_slave_addr[i], 0x40, vformat==PAL?0x00:0x01);
			gpio_i2c_write(vdec_slave_addr[i], 0x41, vformat==PAL?0x00:0x01);
			gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x30);
			gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x30);
			gpio_i2c_write(vdec_slave_addr[i], 0x58, vformat==PAL?0x72:0xae); // resolve long line right black board
			gpio_i2c_write(vdec_slave_addr[i], 0x59, vformat==PAL?0x72:0xae);
//			gpio_i2c_write(vdec_slave_addr[i], 0x58, vformat==PAL?0x64:0xa0);
//			gpio_i2c_write(vdec_slave_addr[i], 0x59, vformat==PAL?0x64:0xa0);
			gpio_i2c_write(vdec_slave_addr[i], 0x5C, 0x9E);
			gpio_i2c_write(vdec_slave_addr[i], 0x5D, 0x9E);
			gpio_i2c_write(vdec_slave_addr[i], 0x64, 0xb1);
			gpio_i2c_write(vdec_slave_addr[i], 0x65, 0xb1);
//			gpio_i2c_write(vdec_slave_addr[i], 0x64, 0x8d);
//			gpio_i2c_write(vdec_slave_addr[i], 0x65, 0x8d);
		}
		
		if(1==ch34_960H)
		{
			gpio_i2c_write(vdec_slave_addr[i], 0x0A, vformat==PAL?0xDD:0xA0);
			gpio_i2c_write(vdec_slave_addr[i], 0x0B, vformat==PAL?0xDD:0xA0);
			gpio_i2c_write(vdec_slave_addr[i], 0x16, 0x90);
			gpio_i2c_write(vdec_slave_addr[i], 0x17, 0x90);
			gpio_i2c_write(vdec_slave_addr[i], 0x19, 0x88);
			gpio_i2c_write(vdec_slave_addr[i], 0x1B, 0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0x1E, vformat==PAL?0x02:0x04);
			gpio_i2c_write(vdec_slave_addr[i], 0x1F, vformat==PAL?0x02:0x04);
			gpio_i2c_write(vdec_slave_addr[i], 0x42, vformat==PAL?0x00:0x01);
			gpio_i2c_write(vdec_slave_addr[i], 0x43, vformat==PAL?0x00:0x01);
			gpio_i2c_write(vdec_slave_addr[i], 0x4A, vformat==PAL?0x00:0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0x4B, vformat==PAL?0x00:0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0x5A, vformat==PAL?0x50:0x33);
			gpio_i2c_write(vdec_slave_addr[i], 0x5B, vformat==PAL?0x50:0x33);
			gpio_i2c_write(vdec_slave_addr[i], 0x5E, 0x1E);
			gpio_i2c_write(vdec_slave_addr[i], 0x5F, 0x1E);
			gpio_i2c_write(vdec_slave_addr[i], 0x66, vformat==PAL?0x0D:0x08);
			gpio_i2c_write(vdec_slave_addr[i], 0x67, vformat==PAL?0x0D:0x08);
		}
		else{
			gpio_i2c_write(vdec_slave_addr[i], 0x0A, 0x60);
			gpio_i2c_write(vdec_slave_addr[i], 0x0B, 0x60);
			gpio_i2c_write(vdec_slave_addr[i], 0x16, 0x9f);
			gpio_i2c_write(vdec_slave_addr[i], 0x17, 0x9f);
			gpio_i2c_write(vdec_slave_addr[i], 0x19, 0x00);		
			gpio_i2c_write(vdec_slave_addr[i], 0x1B, 0x11); 
			gpio_i2c_write(vdec_slave_addr[i], 0x1E, vformat==PAL?0x02:0x04);
			gpio_i2c_write(vdec_slave_addr[i], 0x1F, vformat==PAL?0x02:0x04);
			gpio_i2c_write(vdec_slave_addr[i], 0x42, vformat==PAL?0x00:0x01);
			gpio_i2c_write(vdec_slave_addr[i], 0x43, vformat==PAL?0x00:0x01);
			gpio_i2c_write(vdec_slave_addr[i], 0x4A, 0x30);
			gpio_i2c_write(vdec_slave_addr[i], 0x4B, 0x30);
			gpio_i2c_write(vdec_slave_addr[i], 0x5A, vformat==PAL?0x72:0xae); // resolve long line right black board
			gpio_i2c_write(vdec_slave_addr[i], 0x5B, vformat==PAL?0x72:0xae);
//			gpio_i2c_write(vdec_slave_addr[i], 0x5A, vformat==PAL?0x64:0xa0);
//			gpio_i2c_write(vdec_slave_addr[i], 0x5B, vformat==PAL?0x64:0xa0);
			gpio_i2c_write(vdec_slave_addr[i], 0x5E, 0x9E);
			gpio_i2c_write(vdec_slave_addr[i], 0x5F, 0x9E);
			gpio_i2c_write(vdec_slave_addr[i], 0x66, 0xB1);
			gpio_i2c_write(vdec_slave_addr[i], 0x67, 0xB1);
//			gpio_i2c_write(vdec_slave_addr[i], 0x66, 0x8d);
//			gpio_i2c_write(vdec_slave_addr[i], 0x67, 0x8d);
		}
		
		/************bank 2 diff setting *************/
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x02);  		
		gpio_i2c_write(vdec_slave_addr[i], 0x12, (ch34_960H?0x03:0x00)<<2|(ch12_960H?0x03:0x00));
		gpio_i2c_write(vdec_slave_addr[i], 0x16, (ch12_960H?0x00:0x55));
		gpio_i2c_write(vdec_slave_addr[i], 0x17, (ch34_960H?0x00:0x55));
				
		/************bank 4 diff setting *************/
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x04);   			
		gpio_i2c_write(vdec_slave_addr[i], 0x5C, (ch34_960H?0x00:0x0F)<<4|(ch12_960H?0x00:0x0F));
		gpio_i2c_write(vdec_slave_addr[i], 0x41, (ch34_960H?0x00:0x03)<<2|(ch12_960H?0x00:0x03));
		gpio_i2c_write(vdec_slave_addr[i], 0x40, 0x00);
		if(ch12_960H==1)
		{
			gpio_i2c_write(vdec_slave_addr[i], 0x64, 0x11);
			gpio_i2c_write(vdec_slave_addr[i], 0x68, 0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0x71, 0x55);
			gpio_i2c_write(vdec_slave_addr[i], 0x56, ch34_960H==1?0x00:0x0C);
			gpio_i2c_write(vdec_slave_addr[i], 0x78, 0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0x79, 0x00);
		}
		else{
			gpio_i2c_write(vdec_slave_addr[i], 0x64, 0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0x68, 0x11);
			gpio_i2c_write(vdec_slave_addr[i], 0x71, vformat==PAL?0xAA:0x77);
			gpio_i2c_write(vdec_slave_addr[i], 0x56, ch34_960H==1?0x03:0x0f);
			gpio_i2c_write(vdec_slave_addr[i], 0x78, 0x01);
			gpio_i2c_write(vdec_slave_addr[i], 0x79, 0x01);
		}
		if(ch34_960H==1)
		{
			gpio_i2c_write(vdec_slave_addr[i], 0x65, 0x11);
			gpio_i2c_write(vdec_slave_addr[i], 0x69, 0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0x72, 0x55);	
			gpio_i2c_write(vdec_slave_addr[i], 0x56, ch12_960H==1?0x00:0x03);
			gpio_i2c_write(vdec_slave_addr[i], 0x7A, 0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0x7B, 0x00);
		}
		else {
			gpio_i2c_write(vdec_slave_addr[i], 0x65, 0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0x69, 0x11);
			gpio_i2c_write(vdec_slave_addr[i], 0x72, vformat==PAL?0xAA:0x77);
			gpio_i2c_write(vdec_slave_addr[i], 0x56, ch12_960H==1?0x0c:0x0f);
			gpio_i2c_write(vdec_slave_addr[i], 0x7A, 0x01);
			gpio_i2c_write(vdec_slave_addr[i], 0x7B, 0x01);
		}
		if(1==ch12_960H && 1==ch34_960H)
		{
			gpio_i2c_write(vdec_slave_addr[i], 0x40, 0x60);
			//============== FSC_EXT_VAL ===================//
				gpio_i2c_write(vdec_slave_addr[i], 0x44, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x45, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x46, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x47, 0x51);
				gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x4a, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x4b, 0x51);
		}
		else if(0==ch12_960H && 0==ch34_960H)
		{
			if(vformat == NTSC)
			{
				//============== FSC_EXT_VAL ===================//
				gpio_i2c_write(vdec_slave_addr[i], 0x44, 0xf5);
				gpio_i2c_write(vdec_slave_addr[i], 0x45, 0x28);
				gpio_i2c_write(vdec_slave_addr[i], 0x46, 0x5c);
				gpio_i2c_write(vdec_slave_addr[i], 0x47, 0x51);
				gpio_i2c_write(vdec_slave_addr[i], 0x48, 0xf5);
				gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x28);
				gpio_i2c_write(vdec_slave_addr[i], 0x4a, 0x5c);
				gpio_i2c_write(vdec_slave_addr[i], 0x4b, 0x51);
			}
			else
			{
	
				//============== FSC_EXT_VAL ===================//
				gpio_i2c_write(vdec_slave_addr[i], 0x44, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x45, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x46, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x47, 0x51);
				gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x4a, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x4b, 0x51);			
			}
			
		}
		else if(1==ch12_960H)
		{
			if(vformat == NTSC)
			{
				//============== FSC_EXT_VAL ===================//
				gpio_i2c_write(vdec_slave_addr[i], 0x44, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x45, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x46, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x47, 0x51);
				gpio_i2c_write(vdec_slave_addr[i], 0x48, 0xf5);
				gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x28);
				gpio_i2c_write(vdec_slave_addr[i], 0x4a, 0x5c);
				gpio_i2c_write(vdec_slave_addr[i], 0x4b, 0x51);
			}
			else
			{
				//============== FSC_EXT_VAL ===================//
				gpio_i2c_write(vdec_slave_addr[i], 0x44, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x45, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x46, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x47, 0x51);
				gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x4a, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x4b, 0x51);			
			}
		}
		else if(1==ch34_960H)
		{
			if(vformat == NTSC)
			{
				//============== FSC_EXT_VAL ===================//
				gpio_i2c_write(vdec_slave_addr[i], 0x44, 0xf5);
				gpio_i2c_write(vdec_slave_addr[i], 0x45, 0x28);
				gpio_i2c_write(vdec_slave_addr[i], 0x46, 0x5c);
				gpio_i2c_write(vdec_slave_addr[i], 0x47, 0x51);
				gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x4a, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x4b, 0x51);		
			}
			else
			{
				//============== FSC_EXT_VAL ===================//
				gpio_i2c_write(vdec_slave_addr[i], 0x44, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x45, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x46, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x47, 0x51);
				gpio_i2c_write(vdec_slave_addr[i], 0x48, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x49, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x4a, 0x88);
				gpio_i2c_write(vdec_slave_addr[i], 0x4b, 0x51);			
			}
		}
		/************bank 3 diff setting *************/
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x03);  		
		gpio_i2c_write(vdec_slave_addr[i], 0x53, (ch34_960H?0x03:0x00)<<2|(ch12_960H?0x03:0x00));		
		gpio_i2c_write(vdec_slave_addr[i], 0x2C, vformat==PAL?0x00:0x04);	
		if(0==ch12_960H && 0==ch34_960H)
		{
			//================== Bank3 =====================//
			gpio_i2c_write(vdec_slave_addr[i], 0xff, 0x03);
			//========= Mode Enable for Ch 1~2 =============//
			gpio_i2c_write(vdec_slave_addr[i], 0x29, 0x70);
			gpio_i2c_write(vdec_slave_addr[i], 0x5c, vformat==PAL?0x70:0x60);
			gpio_i2c_write(vdec_slave_addr[i], 0x62, 0x20);
			gpio_i2c_write(vdec_slave_addr[i], 0x05, 0x24);			
			gpio_i2c_write(vdec_slave_addr[i], 0x1b, 0x08);	
			gpio_i2c_write(vdec_slave_addr[i], 0x50, 0x04);			
			gpio_i2c_write(vdec_slave_addr[i], 0x5f, 0x30);
			gpio_i2c_write(vdec_slave_addr[i], 0xD4, 0x80);
			gpio_i2c_write(vdec_slave_addr[i], 0xD5, 0x80);
			gpio_i2c_write(vdec_slave_addr[i], 0xD8, 0x39);
			//================ Bank 5 =====================//
			gpio_i2c_write(vdec_slave_addr[i], 0xff, 0x05);
			//========= Mode Enable for Ch 3~4 =============//
			gpio_i2c_write(vdec_slave_addr[i], 0x29, 0x70);
			gpio_i2c_write(vdec_slave_addr[i], 0x5c, vformat==PAL?0x70:0x60);
			gpio_i2c_write(vdec_slave_addr[i], 0x62, 0x20);			
			gpio_i2c_write(vdec_slave_addr[i], 0x05, 0x24);
			gpio_i2c_write(vdec_slave_addr[i], 0x1b, 0x08);	
			gpio_i2c_write(vdec_slave_addr[i], 0x50, 0x04);			
			gpio_i2c_write(vdec_slave_addr[i], 0x5f, 0x30);
			gpio_i2c_write(vdec_slave_addr[i], 0xD4, 0x80);
			gpio_i2c_write(vdec_slave_addr[i], 0xD5, 0x80);	
			gpio_i2c_write(vdec_slave_addr[i], 0xD8, 0x39);
		}
		else if(1==ch12_960H)
		{
			//================== Bank3 =====================//
			gpio_i2c_write(vdec_slave_addr[i], 0xff, 0x03);
			//========= Mode Enable for Ch 1~2 =============//
			gpio_i2c_write(vdec_slave_addr[i], 0x29, 0x1F);
			gpio_i2c_write(vdec_slave_addr[i], 0x5c, 0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0x62, 0x21);
			gpio_i2c_write(vdec_slave_addr[i], 0x05, 0x20);
			gpio_i2c_write(vdec_slave_addr[i], 0x1b, 0x20);	
			gpio_i2c_write(vdec_slave_addr[i], 0x50, 0x84);			
			gpio_i2c_write(vdec_slave_addr[i], 0x5f, 0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0xD4, 0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0xD5, 0x80);
			gpio_i2c_write(vdec_slave_addr[i], 0xD8, 0xb9);
			//================ Bank 5 =====================//
			gpio_i2c_write(vdec_slave_addr[i], 0xff, 0x05);
			//========= Mode Enable for Ch 3~4 =============//
			gpio_i2c_write(vdec_slave_addr[i], 0x29, 0x70);
			gpio_i2c_write(vdec_slave_addr[i], 0x5c, vformat==PAL?0x70:0x60);
			gpio_i2c_write(vdec_slave_addr[i], 0x62, 0x20);			
			gpio_i2c_write(vdec_slave_addr[i], 0x05, 0x24);
			gpio_i2c_write(vdec_slave_addr[i], 0x1b, 0x08);	
			gpio_i2c_write(vdec_slave_addr[i], 0x50, 0x04);			
			gpio_i2c_write(vdec_slave_addr[i], 0x5f, 0x30);	
			gpio_i2c_write(vdec_slave_addr[i], 0xD4, 0x80);
			gpio_i2c_write(vdec_slave_addr[i], 0xD5, 0x80);
			gpio_i2c_write(vdec_slave_addr[i], 0xD8, 0x39);
		}
		else if(1==ch34_960H)
		{
			//================== Bank3 =====================//
			gpio_i2c_write(vdec_slave_addr[i], 0xff, 0x03);
			//========= Mode Enable for Ch 1~2 =============//
			gpio_i2c_write(vdec_slave_addr[i], 0x29, 0x70);
			gpio_i2c_write(vdec_slave_addr[i], 0x5c, vformat==PAL?0x70:0x60);
			gpio_i2c_write(vdec_slave_addr[i], 0x62, 0x20);
			gpio_i2c_write(vdec_slave_addr[i], 0x05, 0x24);
			gpio_i2c_write(vdec_slave_addr[i], 0x1b, 0x08);	
			gpio_i2c_write(vdec_slave_addr[i], 0x50, 0x04);			
			gpio_i2c_write(vdec_slave_addr[i], 0x5f, 0x30);
			gpio_i2c_write(vdec_slave_addr[i], 0xD4, 0x80);
			gpio_i2c_write(vdec_slave_addr[i], 0xD5, 0x80);
			gpio_i2c_write(vdec_slave_addr[i], 0xD8, 0x39);
			//================ Bank 5 =====================//
			gpio_i2c_write(vdec_slave_addr[i], 0xff, 0x05);
			//========= Mode Enable for Ch 3~4 =============//
			gpio_i2c_write(vdec_slave_addr[i], 0x29, 0x1F);
			gpio_i2c_write(vdec_slave_addr[i], 0x5c, 0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0x62, 0x21);
			gpio_i2c_write(vdec_slave_addr[i], 0x05, 0x20);
			gpio_i2c_write(vdec_slave_addr[i], 0x1b, 0x20);	
			gpio_i2c_write(vdec_slave_addr[i], 0x50, 0x84);			
			gpio_i2c_write(vdec_slave_addr[i], 0x5f, 0x00);	
			gpio_i2c_write(vdec_slave_addr[i], 0xD4, 0x00);
			gpio_i2c_write(vdec_slave_addr[i], 0xD5, 0x80);
			gpio_i2c_write(vdec_slave_addr[i], 0xD8, 0xB9);
		}	
		gpio_i2c_write(vdec_slave_addr[i], 0xff, 0x03);
		gpio_i2c_write(vdec_slave_addr[i], 0x35, vformat==PAL?0x17:0x15);
		gpio_i2c_write(vdec_slave_addr[i], 0xC1, vformat==PAL?0x10:0x30);
		gpio_i2c_write(vdec_slave_addr[i], 0xC2, vformat==PAL?0x0E:0x0C);
		gpio_i2c_write(vdec_slave_addr[i], 0xC3, vformat==PAL?0x70:0x50);
		gpio_i2c_write(vdec_slave_addr[i], 0xC8, vformat==PAL?0x40:0x20);
		gpio_i2c_write(vdec_slave_addr[i], 0xCC, vformat==PAL?0x10:0x20);
		gpio_i2c_write(vdec_slave_addr[i], 0xCD, vformat==PAL?0x08:0x20);
		gpio_i2c_write(vdec_slave_addr[i], 0xCE, vformat==PAL?0x04:0x14);
		gpio_i2c_write(vdec_slave_addr[i], 0xff, 0x05);
		gpio_i2c_write(vdec_slave_addr[i], 0x35, vformat==PAL?0x17:0x15);
		gpio_i2c_write(vdec_slave_addr[i], 0xC1, vformat==PAL?0x10:0x30);
		gpio_i2c_write(vdec_slave_addr[i], 0xC2, vformat==PAL?0x0E:0x0C);
		gpio_i2c_write(vdec_slave_addr[i], 0xC3, vformat==PAL?0x70:0x50);
		gpio_i2c_write(vdec_slave_addr[i], 0xC8, vformat==PAL?0x40:0x20);
		gpio_i2c_write(vdec_slave_addr[i], 0xCC, vformat==PAL?0x10:0x20);
		gpio_i2c_write(vdec_slave_addr[i], 0xCD, vformat==PAL?0x08:0x20);
		gpio_i2c_write(vdec_slave_addr[i], 0xCE, vformat==PAL?0x04:0x14);
		
		/************bank 1 diff setting *************/
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x01);  
		gpio_i2c_write(vdec_slave_addr[i], 0x44, (ch34_960H?0x02:0x01)<<4|(ch12_960H?0x02:0x01));
		gpio_i2c_write(vdec_slave_addr[i], 0x45, (ch34_960H?0x01:0x0B)<<4|(ch12_960H?0x01:0x0B));
		gpio_i2c_write(vdec_slave_addr[i], 0x47, (ch34_960H?0x02:0x05)<<4|(ch12_960H?0x02:0x05));
		gpio_i2c_write(vdec_slave_addr[i], 0x50, (ch34_960H?0x07:0x0D)<<4|(ch12_960H?0x07:0x0D));
		gpio_i2c_write(vdec_slave_addr[i], 0xD3, (ch34_960H?0x00:0x03)<<2|(ch12_960H?0x00:0x03));
		
		if( vdec_cnt == 1 )
		{
			gpio_i2c_write(vdec_slave_addr[i], 0xD4, 0x03);  //mpp1&mpp2 port clock func enables
			if(ch12_960H==0 && ch34_960H==0)
			{
				gpio_i2c_write(vdec_slave_addr[i], 0xCC, 0x56);			
				gpio_i2c_write(vdec_slave_addr[i], 0xCD, 0x56);
				gpio_i2c_write(vdec_slave_addr[i], 0xB4, 0x43);//0x56);//0x43);  //clock&delay setting
				gpio_i2c_write(vdec_slave_addr[i], 0xB5, 0x43);//0x56);//0x43);
			}
			else if(ch12_960H==1 && ch34_960H==1)
			{
				gpio_i2c_write(vdec_slave_addr[i], 0xCC, 0x13);			
				gpio_i2c_write(vdec_slave_addr[i], 0xCD, 0x13);
				gpio_i2c_write(vdec_slave_addr[i], 0xB4, 0x03);//0x56);//0x43);  //clock&delay setting
				gpio_i2c_write(vdec_slave_addr[i], 0xB5, 0x03);//0x56);//0x43);
				
			}
			else if(ch12_960H==1)
			{
				gpio_i2c_write(vdec_slave_addr[i], 0xCC, vformat==PAL?0x56:0x56);
				gpio_i2c_write(vdec_slave_addr[i], 0xCD, vformat==PAL?0x13:0x13);
				gpio_i2c_write(vdec_slave_addr[i], 0xB4, 0x43);//0x56);//0x43);  //clock&delay setting
				gpio_i2c_write(vdec_slave_addr[i], 0xB5, 0x03);//0x56);//0x43);
			}
			else if(ch34_960H==1)
			{
				gpio_i2c_write(vdec_slave_addr[i], 0xCC, vformat==PAL?0x13:0x13);
				gpio_i2c_write(vdec_slave_addr[i], 0xCD, vformat==PAL?0x56:0x56);
				gpio_i2c_write(vdec_slave_addr[i], 0xB4, 0x03);//0x56);//0x43);  //clock&delay setting
				gpio_i2c_write(vdec_slave_addr[i], 0xB5, 0x43);//0x56);//0x43);	
			}
			else
			{
				gpio_i2c_write(vdec_slave_addr[i], 0xCC, 0x56);			
				gpio_i2c_write(vdec_slave_addr[i], 0xCD, 0x56);
				gpio_i2c_write(vdec_slave_addr[i], 0xB4, 0x43);//0x56);//0x43);  //clock&delay setting
				gpio_i2c_write(vdec_slave_addr[i], 0xB5, 0x43);//0x56);//0x43);
			}			
		}
		else
		{
			if(ch12_960H==0 && ch34_960H==0)
			{
				gpio_i2c_write(vdec_slave_addr[i], 0xCC, 0x66);			
				gpio_i2c_write(vdec_slave_addr[i], 0xCD, 0x66);
			}
			else if(ch12_960H==1 && ch34_960H==1)
			{
				gpio_i2c_write(vdec_slave_addr[i], 0xCC, 0x46);			
				gpio_i2c_write(vdec_slave_addr[i], 0xCD, 0x46);
			}
			else if(ch12_960H==1)
			{
				gpio_i2c_write(vdec_slave_addr[i], 0xCC, 0x66);
				gpio_i2c_write(vdec_slave_addr[i], 0xCD, 0x46);
			}
			else if(ch34_960H==1)
			{
				gpio_i2c_write(vdec_slave_addr[i], 0xCC, 0x46);	
				gpio_i2c_write(vdec_slave_addr[i], 0xCD, 0x66);
			}
		}
		
	}
	printk("ch1/2 mode[%s],ch3/4 mode[%s]\n", ch12_960H?"960H":"720P", ch34_960H?"960H":"720P");
}




void nvp6114_720p_30fps(unsigned int i, unsigned char OutMode)
{
//	int i = 0;

	printk("common_init\n");
	vdec_ntsc_common_init(i);

	#ifdef SAMPLING_CLK_72M
//	for(i=0;i<vdec_cnt;i++)
	{		
		//bank1 
		
	}
	printk("\n\rUsing 72M clk SETTING!!!\n");
	#endif
	if(vdec_cnt == 1)
	{
		if( OutMode == 0x0 )
		{
			gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x01);
			gpio_i2c_write(vdec_slave_addr[i], 0xCC, 0x56);
			gpio_i2c_write(vdec_slave_addr[i], 0xCD, 0x56);
		}
		mpp2clk_72M(OutMode);
	}
	vdec_system_init2(i);
	software_reset(i);

	gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x01);
	gpio_i2c_write(vdec_slave_addr[i], 0xCA, 0x03);
			
	printk("\n\rNVP6114 720P@30fps MODE SETTING!!!\n");
}

void nvp6114_720p_25fps(unsigned int i, unsigned char OutMode)
{
//	int i=0;

	vdec_pal_common_init(i);	

	#ifdef SAMPLING_CLK_72M
//	for(i=0;i<vdec_cnt;i++)
	{		
		//bank1 
		
	}
	mpp2clk_72M(OutMode);
	printk("\n\rUsing 72M clk SETTING!!!\n");
	#endif

#if 0 //这一部分是设置背景色，这里把它关闭
	for(i=0;i<vdec_cnt;i++)
	{		
		//bank0 
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x00);
		gpio_i2c_write(vdec_slave_addr[i], 0x78, 0x10+0x44*i);
		gpio_i2c_write(vdec_slave_addr[i], 0x79, 0x32+0x44*i);
		gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x03);
		gpio_i2c_write(vdec_slave_addr[i], 0x2C, 0x08);
	}
#endif
	if(vdec_cnt == 1)
	{
		if( OutMode == 0x0 )
		{
			gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x01);
			gpio_i2c_write(vdec_slave_addr[i], 0xCC, 0x56);
			gpio_i2c_write(vdec_slave_addr[i], 0xCD, 0x56);
		}
		mpp2clk_72M(OutMode);
	}
	vdec_system_init2(i);
	software_reset(i);

	gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x01);
	gpio_i2c_write(vdec_slave_addr[i], 0xCA, 0x03);
	
	printk("\n\rNVP6114 720P@25fps MODE SETTING!!!\n");
}

void vdec_video_set_contrast(unsigned int ch, unsigned int value, unsigned int v_format)
{
    	int num;
	int i = 0;

	if(ch != SET_ALL_CH)
   	{
		gpio_i2c_write(vdec_slave_addr[ch/4], 0xFF, 0x00);
		gpio_i2c_write(vdec_slave_addr[ch/4], (0x10+(ch%4)), value);
		//if(value >= 128)
		//	gpio_i2c_write(vdec_slave_addr[ch/4], (0x10+(ch%4)), (vdec_contrast_tbl[v_format]+value-8));
      	     	//else
		//	gpio_i2c_write(vdec_slave_addr[ch/4], (0x10+(ch%4)), (vdec_contrast_tbl[v_format]+(0xff-(7-value))));
	}
	else
	{
		for(i=0;i<vdec_cnt;i++)
		{
			gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x00);
			for(num=0; num<4; num++)
			{
				gpio_i2c_write(vdec_slave_addr[i], (0x10+(num%4)), value);
				//if(value >= 128)
				//	gpio_i2c_write(vdec_slave_addr[i], (0x10+(num%4)), (vdec_contrast_tbl[v_format]+value-8));
              			//else
				//	gpio_i2c_write(vdec_slave_addr[i], (0x10+(num%4)), (vdec_contrast_tbl[v_format]+(0xff-(7-value))));
			}
		}
	}
}

void vdec_video_set_brightness(unsigned int ch, unsigned int value, unsigned int v_format)
{
    	int num;
	int i=0;
	if(ch != SET_ALL_CH)
    	{
		gpio_i2c_write(vdec_slave_addr[ch/4], 0xFF, 0x00);
		gpio_i2c_write(vdec_slave_addr[ch/4], (0x0c+(ch%4)), (value-0x80));
//		if(value >= 128)
//			gpio_i2c_write(vdec_slave_addr[ch/4], (0x0c+(ch%4)), (vdec_brightness_tbl[v_format]+value-136));
//       	   	else
//			gpio_i2c_write(vdec_slave_addr[ch/4], (0x0c+(ch%4)), (vdec_brightness_tbl[v_format]+(0xff-(135-value))));
	}
	else
	{
		for(i=0;i<vdec_cnt;i++)
		{
			gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x00);	
			for(num=0; num<4; num++)
			{
				gpio_i2c_write(vdec_slave_addr[ch/4], (0x0c+(ch%4)), (value-0x80));
//				if(value >= 128)
//					gpio_i2c_write(vdec_slave_addr[i], (0x0c+(num%4)), (vdec_brightness_tbl[v_format]+value-136));
//              			else
//					gpio_i2c_write(vdec_slave_addr[i], (0x0c+(num%4)), (vdec_brightness_tbl[v_format]+(0xff-(135-value))));
			}
		}
	}
}

void vdec_video_set_saturation(unsigned int ch, unsigned int value, unsigned int v_format)
{
    	int num;
	int i = 0;

	if(ch != SET_ALL_CH)
    	{
		gpio_i2c_write(vdec_slave_addr[ch/4], 0xFF, 0x00);
		gpio_i2c_write(vdec_slave_addr[ch/4], (0x3c+(ch%4)), value);
		//if(value >= 128)
		//	gpio_i2c_write(vdec_slave_addr[ch/4], (0x3c+(ch%4)), (vdec_saturation_tbl[v_format]+value-4));
       	   	//else
		//	gpio_i2c_write(vdec_slave_addr[ch/4], (0x3c+(ch%4)), (vdec_saturation_tbl[v_format]+(0xff-(3-value))));
	}
	else
	{
		for(i=0;i<vdec_cnt;i++)
		{
			gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x00);
			for(num=0; num<4; num++)
			{
				gpio_i2c_write(vdec_slave_addr[i], (0x3c+(num%4)), value);
				//if(value >= 128)
				//	gpio_i2c_write(vdec_slave_addr[i], (0x3c+(num%4)), (vdec_saturation_tbl[v_format]+value-4));
       	   			//else
				//	gpio_i2c_write(vdec_slave_addr[i], (0x3c+(num%4)), (vdec_saturation_tbl[v_format]+(0xff-(3-value))));
			}
		}
	}
}

void vdec_video_set_hue(unsigned int ch, unsigned int value, unsigned int v_format)
{
    	int num;
	int i = 0;
	int value_shift1 = v_format==NTSC ? 125 : 128;
	int value_shift2 = v_format==NTSC ? 124 : 127;

	if(ch != SET_ALL_CH)
 	{
		gpio_i2c_write(vdec_slave_addr[ch/4], 0xFF, 0x00);
		gpio_i2c_write(vdec_slave_addr[ch/4], (0x40+(ch%4)), value-0x80);
		//if(value >= 128)
		//	gpio_i2c_write(vdec_slave_addr[ch/4], (0x40+(ch%4)), (vdec_hue_tbl[v_format]+value-value_shift1));
       	   	//else
		//	gpio_i2c_write(vdec_slave_addr[ch/4], (0x40+(ch%4)), (vdec_hue_tbl[v_format]+(0xff-(value_shift2-value))));
	}
	else
	{
		for(i=0;i<vdec_cnt;i++)
		{
			gpio_i2c_write(vdec_slave_addr[i], 0xFF, 0x00);
			for(num=0; num<4; num++)
			{
				gpio_i2c_write(vdec_slave_addr[i], (0x40+(num%4)), value-0x80);
				//if(value >= 128)
				//	gpio_i2c_write(vdec_slave_addr[i], (0x40+(num%4)), (vdec_hue_tbl[v_format]+value-value_shift1));
       	   			//else
				//	gpio_i2c_write(vdec_slave_addr[i], (0x40+(num%4)), (vdec_hue_tbl[v_format]+(0xff-(value_shift2-value))));
			}
		}
	}
}

void vdec_write_table(unsigned char chip_addr, unsigned char addr, unsigned char *tbl_ptr, unsigned char tbl_cnt)
{
	unsigned char i = 0;
	
	for(i = 0; i < tbl_cnt; i ++)
	{
		gpio_i2c_write(chip_addr, (addr + i), *(tbl_ptr + i));
	}
}

